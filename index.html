<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Hangman Clone</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <style>
      .guess-box {
        height: 30px;
        width: 30px;
        display: inline-block;
        margin-right: 7px;
        position: relative;
        text-align: center;
        font-size: 20px;
      }
      .letter-box {
        border-bottom: 1px solid black;
        height: 40px;
        width: 40px;
        display: inline-block;
        margin-right: 10px;
        position: relative;
        text-align: center;
        font-size: 25px;
      }
      .center-page {
        left: 50%;
        top: 50%;
        width: 300px;
        height: 200px;
        margin-left: -150px;
        margin-top: -100px;
        position: absolute;
        text-align: center;
      }
      .center-page > div {
        font-size: 30px;
        padding: 10px;
      }
      #play-game {
        text-align: center;
        margin-top: 30px;
      }
      #winner {
        background-color: #009933;
        border: 1px solid #003300;
      }
      #loser {
        background-color: #ff3300;
        border: 1px solid #cc3300;
      }
    </style>
  </head>
  <body>
    <div id="start-game" class="center-page">
      <input class="form-control" type="text" id="word" placeholder="Word">
      <input class="form-control" type="number" id="number-of-guesses" placeholder="Guesses">
      <button class="btn btn-primary" onclick="createGame()">Create Game</button>
    </div>
    <div id="play-game" class="container d-none">
      <div class="row justify-content-md-center" id="word-squares">
      </div>
      <br>
      <div class="row justify-content-md-center">
        <input class="form-control" onkeyup="handleGuess(this)" placeholder="Guess Here">
      </div>
      <br>
      <div class="row justify-content-md-center">
        Incorrect guesses left:&nbsp;<span id="remaining-guesses"></span>
      </div>
      <br>
      <div class="row" id="guesses">
      </div>
    </div>
    <div id="winner" class="d-none center-page">
      <div>You win!!!</div>
      <button class="btn btn-outline-secondary" onclick="resetGame(this)">Play Again</button>
    </div>
    <div id="loser" class="d-none center-page">
      <div>You lose!!!</div>
      <button class="btn btn-outline-secondary" onclick="resetGame(this)">Play Again</button>
    </div>
  <script type="text/javascript">

    var wordToGuess = '';
    var guessesLeft = 0;
    var alreadyGuessedLetters = [];

    function createGame() {
      document.querySelector('#start-game').classList.add('d-none');
      document.querySelector('#play-game').classList.remove('d-none');
      wordToGuess = document.querySelector('#word').value;
      guessesLeft = document.querySelector('#number-of-guesses').value;
      document.querySelector('#remaining-guesses').innerHTML = guessesLeft;
      var wordSquares = document.querySelector('#word-squares');
      for (var i = 0; i < wordToGuess.length; i++) {
        var square = document.createElement('div');
        square.classList.add('letter-box');
        square.innerHTML = '*';
        wordSquares.appendChild(square);
      }
    }

    function handleGuess(input) {
      var guess = input.value;
      if (!alreadyGuessedLetters.includes(guess)) {
        var positions = findPositions(guess);
        if (positions.length) {
          populateCorrectGuesses(positions, guess);
        } else {
          recordIncorrectGuess();
        }
        recordGuess(guess);
        if (checkForWinner()) {
          document.querySelector('#winner').classList.remove('d-none');
        } else if (guessesLeft === 0) {
          document.querySelector('#loser').classList.remove('d-none');
        }
      }
      input.value = '';
    }

    function findPositions(guess) {
      var positions = [];
      for (var i = 0; i < wordToGuess.length; i++) {
        if (wordToGuess[i] === guess){
          positions.push(i);
        }
      }
      return positions;
    }

    function populateCorrectGuesses(positions, guess) {
      var wordSquares = document.querySelectorAll('.letter-box');
      for (var i = 0; i < positions.length; i++) {
        wordSquares[positions[i]].innerHTML = guess;
      }
    }

    function recordIncorrectGuess() {
      guessesLeft -= 1;
      document.querySelector('#remaining-guesses').innerHTML = guessesLeft;
    }

    function checkForWinner() {
      var wordSquares = document.querySelectorAll('.letter-box');
      for (var i = 0; i < wordSquares.length; i++) {
        if (wordSquares[i].innerHTML === '*') {
          return false;
        }
      }
      return true;
    }

    function recordGuess(guess) {
      var guessBox = document.createElement('div');
      guessBox.classList.add('guess-box');
      guessBox.innerHTML = guess;
      document.querySelector('#guesses').appendChild(guessBox)
    }

    function resetGame(result) {
      document.querySelector('#winner').classList.add('d-none');
      document.querySelector('#loser').classList.add('d-none');
      document.querySelector('#play-game').classList.add('d-none');
      document.querySelector('#start-game').classList.remove('d-none');
      document.querySelector('#word-squares').innerHTML = '';
      document.querySelector('#guesses').innerHTML = '';
    }
  </script>
  </body>
</html>
